<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>464-can_i_win - Peter's Coding Notes</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://peter14f.github.io/pelican-blog/464-can_i_win.html">

        <meta name="author" content="Peter Hsieh" />
        <meta name="keywords" content="Dynamic Programming,Recursion,Minimax,Bit Manipulation,Memoization" />
        <meta name="description" content="LeetCode Problem Link Unlike the other Minimax problems (486-predict_the_winner and 375-guess_number_higher_or_lower_ii), we cannot specify a range for the input and work out shortening that range because in this problem, the player is free to pick from any number that is still available. The problem description says that n will not be bigger than 20. This means that we could use a bit to represent what numbers are still left. Here is the purely recursive solution with no memoization. Once you make a pick, you want to know if the other player can win with whatever is left. If the the ..." />

        <meta property="og:site_name" content="Peter's Coding Notes" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="464-can_i_win"/>
        <meta property="og:url" content="http://peter14f.github.io/pelican-blog/464-can_i_win.html"/>
        <meta property="og:description" content="LeetCode Problem Link Unlike the other Minimax problems (486-predict_the_winner and 375-guess_number_higher_or_lower_ii), we cannot specify a range for the input and work out shortening that range because in this problem, the player is free to pick from any number that is still available. The problem description says that n will not be bigger than 20. This means that we could use a bit to represent what numbers are still left. Here is the purely recursive solution with no memoization. Once you make a pick, you want to know if the other player can win with whatever is left. If the the ..."/>
        <meta property="article:published_time" content="2018-03-17" />
            <meta property="article:section" content="LeetCode" />
            <meta property="article:tag" content="Dynamic Programming" />
            <meta property="article:tag" content="Recursion" />
            <meta property="article:tag" content="Minimax" />
            <meta property="article:tag" content="Bit Manipulation" />
            <meta property="article:tag" content="Memoization" />
            <meta property="article:author" content="Peter Hsieh" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://peter14f.github.io/pelican-blog/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://peter14f.github.io/pelican-blog/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://peter14f.github.io/pelican-blog/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://peter14f.github.io/pelican-blog/theme/css/style.css" type="text/css"/>

        <link href="http://peter14f.github.io/pelican-blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Peter's Coding Notes ATOM Feed"/>



        <link href="http://peter14f.github.io/pelican-blog/feeds/leetcode.atom.xml" type="application/atom+xml" rel="alternate"
              title="Peter's Coding Notes LeetCode ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://peter14f.github.io/pelican-blog/" class="navbar-brand">
Peter's Coding Notes            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="http://peter14f.github.io/pelican-blog/category/data-structures.html">Data structures</a>
                        </li>
                        <li class="active">
                            <a href="http://peter14f.github.io/pelican-blog/category/leetcode.html">Leetcode</a>
                        </li>
                        <li >
                            <a href="http://peter14f.github.io/pelican-blog/category/misc.html">Misc</a>
                        </li>
                        <li >
                            <a href="http://peter14f.github.io/pelican-blog/category/more-questions.html">More questions</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://peter14f.github.io/pelican-blog/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
                <h2>
                    <a href="http://peter14f.github.io/pelican-blog/464-can_i_win.html"
                       rel="bookmark"
                       title="Permalink to 464-can_i_win">
                        464-can_i_win
                    </a>
                </h2>
            <div class="entry-content">
<footer class="post-info">
    <span class="published label label-default">
        <time datetime="2018-03-17T20:53:00-07:00"> Mar 17 2018</time>
    </span>





<span class="label label-default tag-lists">Tags</span>
	<a href="http://peter14f.github.io/pelican-blog/tag/dynamic-programming.html">Dynamic Programming</a>
        /
	<a href="http://peter14f.github.io/pelican-blog/tag/recursion.html">Recursion</a>
        /
	<a href="http://peter14f.github.io/pelican-blog/tag/minimax.html">Minimax</a>
        /
	<a href="http://peter14f.github.io/pelican-blog/tag/bit-manipulation.html">Bit Manipulation</a>
        /
	<a href="http://peter14f.github.io/pelican-blog/tag/memoization.html">Memoization</a>
    
</footer><!-- /.post-info -->                <div class="full-article">
                <p><a class="reference external" href="https://leetcode.com/problems/can-i-win/">LeetCode Problem Link</a></p>
<p>Unlike the other Minimax problems (486-predict_the_winner and 375-guess_number_higher_or_lower_ii),
we cannot specify a range for the input and work out shortening that range because in this
problem, the player is free to pick from any number that is still available.</p>
<p>The problem description says that <tt class="docutils literal">n</tt> will not be bigger than 20. This means that
we could use a bit to represent what numbers are still left.</p>
<p>Here is the purely recursive solution with no memoization.
Once you make a pick, you want to know if the other player can win with whatever is left.
If the the other cannot win with whatever is left, then you know you will win the game.</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">canIWinRecursion</span><span class="o">(</span><span class="kt">int</span> <span class="n">maxChoosableInteger</span><span class="o">,</span> <span class="kt">int</span> <span class="n">desiredTotal</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">maxChoosableInteger</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">total</span> <span class="o">=</span> <span class="n">n</span><span class="o">*(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="o">)/</span><span class="mi">2</span><span class="o">;</span>

    <span class="c1">// desiredTotal not reachable</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">total</span> <span class="o">&lt;</span> <span class="n">desiredTotal</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kt">int</span> <span class="n">bitMask</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="o">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
    <span class="k">return</span> <span class="n">canIWinHelper</span><span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="n">bitMask</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">desiredTotal</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">canIWinHelper</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">,</span> <span class="kt">int</span> <span class="n">bitMask</span><span class="o">,</span> <span class="kt">int</span> <span class="n">curSum</span><span class="o">,</span> <span class="kt">int</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">curSum</span> <span class="o">&gt;=</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">bitMask</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">((</span><span class="n">bitMask</span> <span class="o">&amp;</span> <span class="o">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="o">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>

            <span class="kt">int</span> <span class="n">newSum</span> <span class="o">=</span> <span class="n">curSum</span> <span class="o">+</span> <span class="n">num</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">newSum</span> <span class="o">&gt;=</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="kt">int</span> <span class="n">bitMaskLeft</span> <span class="o">=</span> <span class="n">bitMask</span> <span class="o">^</span> <span class="o">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="o">);</span>
            <span class="c1">// what&#39;s left -&gt; if the other player cannot win</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">canIWinHelper</span><span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="n">bitMaskLeft</span><span class="o">,</span> <span class="n">newSum</span><span class="o">,</span> <span class="n">target</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">// non of the number I pick will result in the other player unable to win</span>
    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
<p>We will use a Map&lt;Integer, Boolean&gt; to store the results to the subproblems to prevent
doing repeated work.</p>
<div class="highlight"><pre><span class="c1">// player1 and player2 take turns</span>
<span class="c1">// after pick, if the running total &gt;= desiredTotal, then the player wins</span>
<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">canIWin</span><span class="o">(</span><span class="kt">int</span> <span class="n">maxChoosableInteger</span><span class="o">,</span> <span class="kt">int</span> <span class="n">desiredTotal</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">maxChoosableInteger</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">n</span><span class="o">*(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="o">)/</span><span class="mi">2</span><span class="o">;</span>

    <span class="c1">// neither player will be able to win</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">sum</span> <span class="o">&lt;</span> <span class="n">desiredTotal</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kt">int</span> <span class="n">bitMaskLeft</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>

    <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">memoization</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="k">return</span> <span class="n">canPlayerWin</span><span class="o">(</span><span class="n">memoization</span><span class="o">,</span> <span class="n">n</span><span class="o">,</span> <span class="n">bitMaskLeft</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">desiredTotal</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// curSum + newNum &gt;= target, then player wins the game</span>
<span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">canPlayerWin</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">memoization</span><span class="o">,</span>
        <span class="kt">int</span> <span class="n">n</span><span class="o">,</span>
        <span class="kt">int</span> <span class="n">bitMask</span><span class="o">,</span> <span class="kt">int</span> <span class="n">curSum</span><span class="o">,</span> <span class="kt">int</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">curSum</span> <span class="o">&gt;=</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">memoization</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">bitMask</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">bitMask</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">memoization</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">bitMask</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">bitMask</span><span class="o">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="kt">int</span> <span class="n">newBitMask</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="o">)^</span><span class="n">bitMask</span><span class="o">;</span> <span class="c1">// what&#39;s left after I pick num</span>
            <span class="kt">int</span> <span class="n">newSum</span> <span class="o">=</span> <span class="n">curSum</span> <span class="o">+</span> <span class="n">num</span><span class="o">;</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">newSum</span> <span class="o">&gt;=</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">memoization</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">newBitMask</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">memoization</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">newBitMask</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">memoization</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">bitMask</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="c1">// if I pick num, will the other player lose?</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">canPlayerWin</span><span class="o">(</span><span class="n">memoization</span><span class="o">,</span> <span class="n">n</span><span class="o">,</span> <span class="n">newBitMask</span><span class="o">,</span> <span class="n">newSum</span><span class="o">,</span> <span class="n">target</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">memoization</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">bitMask</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">// whatever available number left I pick will not lead to the other player losing...</span>
    <span class="n">memoization</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">bitMask</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>

                </div>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Peter Hsieh
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://peter14f.github.io/pelican-blog/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://peter14f.github.io/pelican-blog/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://peter14f.github.io/pelican-blog/theme/js/respond.min.js"></script>


</body>
</html>