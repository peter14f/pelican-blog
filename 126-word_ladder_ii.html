<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>126-word_ladder_ii - Peter's Coding Notes</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://peter14f.github.io/pelican-blog/126-word_ladder_ii.html">

        <meta name="author" content="Peter Hsieh" />
        <meta name="keywords" content="Find All Shortest Paths,BFS,DFS,Two-Way BFS" />
        <meta name="description" content="LeetCode Problem Link We must first perform BFS find out the length of the shortest path. While doing this, we should save the choices at each level. When we have found the length of the shortest path and the choices at each level, we can then perform DFS to find all shortest paths. What info do we need when we perform the DFS? We must know the neighbors of each word at each level. Therefore, it is important that we build the neighbors as part of the BFS. I used a HashMap&lt;String, HashSet&gt; for this. The key is string ..." />

        <meta property="og:site_name" content="Peter's Coding Notes" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="126-word_ladder_ii"/>
        <meta property="og:url" content="http://peter14f.github.io/pelican-blog/126-word_ladder_ii.html"/>
        <meta property="og:description" content="LeetCode Problem Link We must first perform BFS find out the length of the shortest path. While doing this, we should save the choices at each level. When we have found the length of the shortest path and the choices at each level, we can then perform DFS to find all shortest paths. What info do we need when we perform the DFS? We must know the neighbors of each word at each level. Therefore, it is important that we build the neighbors as part of the BFS. I used a HashMap&lt;String, HashSet&gt; for this. The key is string ..."/>
        <meta property="article:published_time" content="2015-12-05" />
            <meta property="article:section" content="LeetCode" />
            <meta property="article:tag" content="Find All Shortest Paths" />
            <meta property="article:tag" content="BFS" />
            <meta property="article:tag" content="DFS" />
            <meta property="article:tag" content="Two-Way BFS" />
            <meta property="article:author" content="Peter Hsieh" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://peter14f.github.io/pelican-blog/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://peter14f.github.io/pelican-blog/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://peter14f.github.io/pelican-blog/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://peter14f.github.io/pelican-blog/theme/css/style.css" type="text/css"/>

        <link href="http://peter14f.github.io/pelican-blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Peter's Coding Notes ATOM Feed"/>



        <link href="http://peter14f.github.io/pelican-blog/feeds/leetcode.atom.xml" type="application/atom+xml" rel="alternate"
              title="Peter's Coding Notes LeetCode ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://peter14f.github.io/pelican-blog/" class="navbar-brand">
Peter's Coding Notes            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li class="active">
                            <a href="http://peter14f.github.io/pelican-blog/category/leetcode.html">Leetcode</a>
                        </li>
                        <li >
                            <a href="http://peter14f.github.io/pelican-blog/category/misc.html">Misc</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://peter14f.github.io/pelican-blog/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
                <h2>
                    <a href="http://peter14f.github.io/pelican-blog/126-word_ladder_ii.html"
                       rel="bookmark"
                       title="Permalink to 126-word_ladder_ii">
                        126-word_ladder_ii
                    </a>
                </h2>
            <div class="entry-content">
<footer class="post-info">
    <span class="published label label-default">
        <time datetime="2015-12-05T16:39:00-08:00"> Dec 05 2015</time>
    </span>





<span class="label label-default tag-lists">Tags</span>
	<a href="http://peter14f.github.io/pelican-blog/tag/find-all-shortest-paths.html">Find All Shortest Paths</a>
        /
	<a href="http://peter14f.github.io/pelican-blog/tag/bfs.html">BFS</a>
        /
	<a href="http://peter14f.github.io/pelican-blog/tag/dfs.html">DFS</a>
        /
	<a href="http://peter14f.github.io/pelican-blog/tag/two-way-bfs.html">Two-Way BFS</a>
    
</footer><!-- /.post-info -->                <div class="full-article">
                <p><a class="reference external" href="https://leetcode.com/problems/word-ladder-ii/">LeetCode Problem Link</a></p>
<p>We must first perform BFS find out the length of the shortest path. While doing this, we should
save the choices at each level. When we have found the length of the shortest path and the
choices at each level, we can then perform DFS to find all shortest paths. What info do we need
when we perform the DFS? We must know the neighbors of each word at each level. Therefore, it is important
that we build the neighbors as part of the BFS. I used a HashMap&lt;String, HashSet&gt; for this. The key is string in
question and its value is a HashSet of strings which are the neighbors of that string. This simply records the
neighboring relationship, it has nothing to do with the data structure that we use to prevent duplicates being
inserted onto the BFS queue.</p>
<div class="highlight"><pre><span class="c1">// find all shortest transformations</span>
<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="nf">findLadders</span><span class="o">(</span><span class="n">String</span> <span class="n">beginWord</span><span class="o">,</span> <span class="n">String</span> <span class="n">endWord</span><span class="o">,</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">wordList</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">q</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">dup</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">q</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">beginWord</span><span class="o">);</span>

    <span class="kt">int</span> <span class="n">nextLevelSize</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">curLevelSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">level</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">levelWords</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">curLevelWords</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>

    <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">neighbors</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>

    <span class="k">while</span> <span class="o">(!</span><span class="n">q</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>

        <span class="n">String</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
        <span class="kt">char</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
        <span class="n">curLevelWords</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">cur</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">arr</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">char</span> <span class="n">oldC</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>

            <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">c</span><span class="o">=</span><span class="sc">&#39;a&#39;</span><span class="o">;</span> <span class="n">c</span><span class="o">&lt;=</span><span class="sc">&#39;z&#39;</span><span class="o">;</span> <span class="n">c</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">oldC</span><span class="o">)</span>
                    <span class="k">continue</span><span class="o">;</span>

                <span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>


                <span class="n">String</span> <span class="n">modified</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">arr</span><span class="o">);</span>
                <span class="kt">boolean</span> <span class="n">reachedEnd</span> <span class="o">=</span> <span class="n">modified</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">endWord</span><span class="o">);</span>

                <span class="k">if</span> <span class="o">(</span><span class="n">wordList</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">modified</span><span class="o">)</span> <span class="o">||</span> <span class="n">reachedEnd</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">neighbors</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">cur</span><span class="o">))</span> <span class="o">{</span>
                        <span class="k">if</span> <span class="o">(!</span><span class="n">neighbors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cur</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">modified</span><span class="o">))</span>
                            <span class="n">neighbors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cur</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="k">else</span> <span class="o">{</span>
                        <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">myNeighbors</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
                        <span class="n">myNeighbors</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>
                        <span class="n">neighbors</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">cur</span><span class="o">,</span> <span class="n">myNeighbors</span><span class="o">);</span>
                    <span class="o">}</span>

                    <span class="k">if</span> <span class="o">(</span><span class="n">dup</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">modified</span><span class="o">))</span>
                        <span class="k">continue</span><span class="o">;</span>

                    <span class="k">if</span> <span class="o">(</span><span class="n">levels</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">reachedEnd</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">levels</span> <span class="o">=</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
                    <span class="o">}</span>

                    <span class="n">q</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>
                    <span class="n">dup</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>

                    <span class="n">nextLevelSize</span><span class="o">++;</span>
                <span class="o">}</span>

            <span class="o">}</span>

            <span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">oldC</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">curLevelSize</span><span class="o">--;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">curLevelSize</span><span class="o">==</span><span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">levelWords</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">curLevelWords</span><span class="o">));</span>
            <span class="n">curLevelWords</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>

            <span class="n">curLevelSize</span> <span class="o">=</span> <span class="n">nextLevelSize</span><span class="o">;</span>
            <span class="n">nextLevelSize</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">level</span><span class="o">++;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">level</span> <span class="o">==</span> <span class="n">levels</span><span class="o">)</span>
                <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">ans</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>
    <span class="n">dfs</span><span class="o">(</span><span class="n">levelWords</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(),</span> <span class="n">neighbors</span><span class="o">,</span> <span class="n">ans</span><span class="o">,</span> <span class="n">levels</span><span class="o">,</span> <span class="n">endWord</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">void</span> <span class="nf">dfs</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">levelWords</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">curList</span><span class="o">,</span>
                 <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">neighbors</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">ans</span><span class="o">,</span>
                 <span class="kt">int</span> <span class="n">levels</span><span class="o">,</span> <span class="n">String</span> <span class="n">endWord</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words</span> <span class="o">=</span> <span class="n">levelWords</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>

    <span class="kt">int</span> <span class="n">origSize</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">origSize</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
        <span class="k">return</span><span class="o">;</span>

    <span class="n">String</span> <span class="n">last</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">curList</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">curList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">curList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">origSize</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">last</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">neighbors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">last</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">s</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">curList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">curList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">levels</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">dfs</span><span class="o">(</span><span class="n">levelWords</span><span class="o">,</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">curList</span><span class="o">,</span> <span class="n">neighbors</span><span class="o">,</span> <span class="n">ans</span><span class="o">,</span> <span class="n">levels</span><span class="o">,</span> <span class="n">endWord</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">neighbors</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">neighbors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">endWord</span><span class="o">))</span> <span class="o">{</span>
                    <span class="n">curList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">endWord</span><span class="o">);</span>
                    <span class="n">ans</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">curList</span><span class="o">));</span>
                    <span class="n">curList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">curList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>

            <span class="n">curList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">curList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
<p>This approach won't pass the large test case on OJ. If we decrease the number of choices at each level, the spent on
the DFS can be reduced (think exponential time complexity). The way we could decrease the number of choices at each
level is to perform BFS from the other end. Only the words that appear at that level from both times ar the choices
worth considering.</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="nf">findLadders</span><span class="o">(</span>
        <span class="n">String</span> <span class="n">beginWord</span><span class="o">,</span>
        <span class="n">String</span> <span class="n">endWord</span><span class="o">,</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">wordList</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">levelWords</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">q</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">dup</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">neighbors</span> <span class="o">=</span>
            <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>

    <span class="n">q</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">beginWord</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">curLevelSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">nextLevelSize</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">level</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

    <span class="k">while</span> <span class="o">(!</span><span class="n">q</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
        <span class="kt">char</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">arr</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">char</span> <span class="n">oldChar</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>

            <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">c</span><span class="o">=</span><span class="sc">&#39;a&#39;</span><span class="o">;</span> <span class="n">c</span><span class="o">&lt;=</span><span class="sc">&#39;z&#39;</span><span class="o">;</span> <span class="n">c</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">oldChar</span><span class="o">)</span>
                    <span class="k">continue</span><span class="o">;</span>

                <span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
                <span class="n">String</span> <span class="n">modified</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">arr</span><span class="o">);</span>
                <span class="kt">boolean</span> <span class="n">reachedEnd</span> <span class="o">=</span> <span class="n">modified</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">endWord</span><span class="o">);</span>

                <span class="k">if</span> <span class="o">(</span><span class="n">wordList</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">modified</span><span class="o">)</span> <span class="o">||</span> <span class="n">reachedEnd</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(!</span><span class="n">neighbors</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">cur</span><span class="o">))</span>
                        <span class="n">neighbors</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">cur</span><span class="o">,</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;());</span>

                    <span class="k">if</span> <span class="o">(!</span><span class="n">neighbors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cur</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">modified</span><span class="o">))</span>
                        <span class="n">neighbors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cur</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>

                    <span class="k">if</span> <span class="o">(</span><span class="n">dup</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">modified</span><span class="o">))</span> <span class="o">{</span>
                        <span class="k">continue</span><span class="o">;</span>
                    <span class="o">}</span>

                    <span class="k">if</span> <span class="o">(</span><span class="n">reachedEnd</span> <span class="o">&amp;&amp;</span> <span class="n">levels</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">levels</span> <span class="o">=</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
                    <span class="o">}</span>

                    <span class="n">q</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>

                    <span class="k">if</span> <span class="o">(!</span><span class="n">reachedEnd</span><span class="o">)</span>
                        <span class="n">dup</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>

                    <span class="n">nextLevelSize</span><span class="o">++;</span>
                <span class="o">}</span>

            <span class="o">}</span>

            <span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">oldChar</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">curLevelSize</span><span class="o">--;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">levelWords</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">level</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
            <span class="n">words</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">cur</span><span class="o">);</span>
            <span class="n">levelWords</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">words</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">levelWords</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">level</span><span class="o">-</span><span class="mi">1</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="n">cur</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">curLevelSize</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">levels</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
                <span class="k">break</span><span class="o">;</span>

            <span class="n">level</span><span class="o">++;</span>
            <span class="n">curLevelSize</span> <span class="o">=</span> <span class="n">nextLevelSize</span><span class="o">;</span>
            <span class="n">nextLevelSize</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">ans</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">levels</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">levels</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">q</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
        <span class="n">dup</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>

        <span class="n">q</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">endWord</span><span class="o">);</span>
        <span class="n">curLevelSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="n">nextLevelSize</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">level</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">levels</span> <span class="o">-</span> <span class="mi">2</span><span class="o">;</span>
        <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">replacedWords</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>

        <span class="k">while</span> <span class="o">(!</span><span class="n">q</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
            <span class="kt">char</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>

            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">arr</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="kt">char</span> <span class="n">oldC</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>

                <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">c</span><span class="o">=</span><span class="sc">&#39;a&#39;</span><span class="o">;</span> <span class="n">c</span><span class="o">&lt;=</span><span class="sc">&#39;z&#39;</span><span class="o">;</span> <span class="n">c</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">c</span><span class="o">==</span><span class="n">oldC</span><span class="o">)</span>
                        <span class="k">continue</span><span class="o">;</span>

                    <span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>

                    <span class="n">String</span> <span class="n">modified</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">arr</span><span class="o">);</span>
                    <span class="kt">boolean</span> <span class="n">reachedEnd</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

                    <span class="k">if</span> <span class="o">(</span><span class="n">level</span> <span class="o">==</span> <span class="n">levels</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span>
                        <span class="n">reachedEnd</span> <span class="o">=</span> <span class="n">modified</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">beginWord</span><span class="o">);</span>

                    <span class="k">if</span> <span class="o">(</span><span class="n">wordList</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">modified</span><span class="o">)</span> <span class="o">||</span> <span class="n">reachedEnd</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">dup</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">modified</span><span class="o">))</span>
                            <span class="k">continue</span><span class="o">;</span>

                        <span class="k">if</span> <span class="o">(</span><span class="n">levelWords</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">modified</span><span class="o">))</span> <span class="o">{</span>
                            <span class="n">replacedWords</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>

                            <span class="n">q</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>
                            <span class="n">dup</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">modified</span><span class="o">);</span>
                            <span class="n">nextLevelSize</span><span class="o">++;</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                <span class="o">}</span>

                <span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">oldC</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="n">curLevelSize</span><span class="o">--;</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">curLevelSize</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">oldWords</span> <span class="o">=</span> <span class="n">levelWords</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>
                    <span class="n">levelWords</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">index</span><span class="o">,</span> <span class="n">replacedWords</span><span class="o">);</span>
                    <span class="n">replacedWords</span> <span class="o">=</span> <span class="n">oldWords</span><span class="o">;</span>
                <span class="o">}</span>

                <span class="n">index</span><span class="o">--;</span>
                <span class="n">replacedWords</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>

                <span class="n">level</span><span class="o">++;</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
                    <span class="k">break</span><span class="o">;</span>

                <span class="n">curLevelSize</span> <span class="o">=</span> <span class="n">nextLevelSize</span><span class="o">;</span>
                <span class="n">nextLevelSize</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">dfs</span><span class="o">(</span><span class="n">levelWords</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(),</span> <span class="n">neighbors</span><span class="o">,</span> <span class="n">levels</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">ans</span><span class="o">,</span> <span class="n">endWord</span><span class="o">);</span>

    <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">void</span> <span class="nf">dfs</span><span class="o">(</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">levelWords</span><span class="o">,</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">curList</span><span class="o">,</span>
        <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">neighbors</span><span class="o">,</span>
        <span class="kt">int</span> <span class="n">levels</span><span class="o">,</span>
        <span class="kt">int</span> <span class="n">index</span><span class="o">,</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">ans</span><span class="o">,</span>
        <span class="n">String</span> <span class="n">endWord</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words</span> <span class="o">=</span> <span class="n">levelWords</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>

    <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">:</span> <span class="n">words</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">String</span> <span class="n">prevWord</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(!</span><span class="n">curList</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span>
            <span class="n">prevWord</span> <span class="o">=</span> <span class="n">curList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">curList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">curList</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">||</span> <span class="o">(</span><span class="n">neighbors</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">prevWord</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">neighbors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">prevWord</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">s</span><span class="o">)))</span> <span class="o">{</span>
            <span class="n">curList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">curList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">levels</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">dfs</span><span class="o">(</span><span class="n">levelWords</span><span class="o">,</span> <span class="n">curList</span><span class="o">,</span> <span class="n">neighbors</span><span class="o">,</span> <span class="n">levels</span><span class="o">,</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">ans</span><span class="o">,</span> <span class="n">endWord</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">neighbors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">endWord</span><span class="o">))</span> <span class="o">{</span>
                    <span class="n">curList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">endWord</span><span class="o">);</span>
                    <span class="n">ans</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">curList</span><span class="o">));</span>
                    <span class="n">curList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">curList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">curList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">curList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

                </div>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Peter Hsieh
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://peter14f.github.io/pelican-blog/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://peter14f.github.io/pelican-blog/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://peter14f.github.io/pelican-blog/theme/js/respond.min.js"></script>


</body>
</html>