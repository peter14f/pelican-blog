<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>123-best_time_to_buy_and_sell_stock_iii - Peter's Coding Notes</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://peter14f.github.io/pelican-blog/123-best_time_to_buy_and_sell_stock_iii.html">

        <meta name="author" content="Peter Hsieh" />
        <meta name="keywords" content="Dynamic Programming" />
        <meta name="description" content="LeetCode Problem Link We can make at most two transactions. That means if i goes from 1 to n-2, we would go through all the possible ways to partition the prices into two groups. The first group is prices[0..i] and second group is prices[i+1, n-1]. So here is one way we could solve the problem. We see if making one transaction yields more profit or any of the ways making two transactions yields more profit. public int maxProfit(int[] prices) { int maxProfit = maxProfitOne(prices, 0, prices.length-1); for (int i=1; i&lt;prices.length-2 ..." />

        <meta property="og:site_name" content="Peter's Coding Notes" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="123-best_time_to_buy_and_sell_stock_iii"/>
        <meta property="og:url" content="http://peter14f.github.io/pelican-blog/123-best_time_to_buy_and_sell_stock_iii.html"/>
        <meta property="og:description" content="LeetCode Problem Link We can make at most two transactions. That means if i goes from 1 to n-2, we would go through all the possible ways to partition the prices into two groups. The first group is prices[0..i] and second group is prices[i+1, n-1]. So here is one way we could solve the problem. We see if making one transaction yields more profit or any of the ways making two transactions yields more profit. public int maxProfit(int[] prices) { int maxProfit = maxProfitOne(prices, 0, prices.length-1); for (int i=1; i&lt;prices.length-2 ..."/>
        <meta property="article:published_time" content="2015-12-01" />
            <meta property="article:section" content="LeetCode" />
            <meta property="article:tag" content="Dynamic Programming" />
            <meta property="article:author" content="Peter Hsieh" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://peter14f.github.io/pelican-blog/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://peter14f.github.io/pelican-blog/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://peter14f.github.io/pelican-blog/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://peter14f.github.io/pelican-blog/theme/css/style.css" type="text/css"/>

        <link href="http://peter14f.github.io/pelican-blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Peter's Coding Notes ATOM Feed"/>



        <link href="http://peter14f.github.io/pelican-blog/feeds/leetcode.atom.xml" type="application/atom+xml" rel="alternate"
              title="Peter's Coding Notes LeetCode ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://peter14f.github.io/pelican-blog/" class="navbar-brand">
Peter's Coding Notes            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li class="active">
                            <a href="http://peter14f.github.io/pelican-blog/category/leetcode.html">Leetcode</a>
                        </li>
                        <li >
                            <a href="http://peter14f.github.io/pelican-blog/category/misc.html">Misc</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://peter14f.github.io/pelican-blog/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
                <h2>
                    <a href="http://peter14f.github.io/pelican-blog/123-best_time_to_buy_and_sell_stock_iii.html"
                       rel="bookmark"
                       title="Permalink to 123-best_time_to_buy_and_sell_stock_iii">
                        123-best_time_to_buy_and_sell_stock_iii
                    </a>
                </h2>
            <div class="entry-content">
<footer class="post-info">
    <span class="published label label-default">
        <time datetime="2015-12-01T17:56:00-08:00"> Dec 01 2015</time>
    </span>





<span class="label label-default tag-lists">Tags</span>
	<a href="http://peter14f.github.io/pelican-blog/tag/dynamic-programming.html">Dynamic Programming</a>
    
</footer><!-- /.post-info -->                <div class="full-article">
                <p><a class="reference external" href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-iii/">LeetCode Problem Link</a></p>
<p>We can make at most two transactions. That means if i goes from <tt class="docutils literal">1</tt> to <tt class="docutils literal"><span class="pre">n-2</span></tt>, we would go
through all the possible ways to partition the prices into two groups. The first group is prices[0..i]
and second group is prices[i+1, n-1].</p>
<p>So here is one way we could solve the problem. We see if making one transaction yields more profit or
any of the ways making two transactions yields more profit.</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="kt">int</span> <span class="nf">maxProfit</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">prices</span><span class="o">)</span> <span class="o">{</span>

    <span class="kt">int</span> <span class="n">maxProfit</span> <span class="o">=</span> <span class="n">maxProfitOne</span><span class="o">(</span><span class="n">prices</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">prices</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">prices</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">2</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">profit</span> <span class="o">=</span> <span class="n">maxProfitOne</span><span class="o">(</span><span class="n">prices</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">+</span> <span class="n">maxProfitOne</span><span class="o">(</span><span class="n">prices</span><span class="o">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">prices</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">profit</span> <span class="o">&gt;</span> <span class="n">maxProfit</span><span class="o">)</span>
            <span class="n">maxProfit</span> <span class="o">=</span> <span class="n">profit</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">maxProfit</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">int</span> <span class="nf">maxProfitOne</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">prices</span><span class="o">,</span> <span class="kt">int</span> <span class="n">low</span><span class="o">,</span> <span class="kt">int</span> <span class="n">high</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">buyIndex</span> <span class="o">=</span> <span class="n">low</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">maxProfit</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">low</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">high</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&lt;</span> <span class="n">prices</span><span class="o">[</span><span class="n">buyIndex</span><span class="o">])</span> <span class="o">{</span>
            <span class="n">buyIndex</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">profit</span> <span class="o">=</span> <span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">-</span> <span class="n">prices</span><span class="o">[</span><span class="n">buyIndex</span><span class="o">];</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">profit</span> <span class="o">&gt;</span> <span class="n">maxProfit</span><span class="o">)</span>
                <span class="n">maxProfit</span> <span class="o">=</span> <span class="n">profit</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">maxProfit</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
<p>What's the time complexity for this approach? Outer loop iterates <tt class="docutils literal">n</tt> times and the inner loop iterates <tt class="docutils literal">n</tt>
Unfortunately this won't pass the gigantic test case on OJ. So let's now look at the dynamic programming approach.</p>
<p>For the DP approach, we will maintain two int array <tt class="docutils literal">profit1</tt> and <tt class="docutils literal">profit2</tt>, each of size <tt class="docutils literal">n</tt>. <tt class="docutils literal">profit1[i]</tt> is
the maximum profit made with one transaction only and considering the prices from index 0 to index i .</p>
<p><tt class="docutils literal">profit2[i]</tt> is the maximum profit made with one transaction only considering the
prices from index i to index n-1. We will fill out <tt class="docutils literal">profit1</tt> from index <tt class="docutils literal">0</tt> all the way up to index <tt class="docutils literal"><span class="pre">n-1</span></tt>.
We know what to do when we see a new price just like in 121-best_time_to_buy_and_sell_stock. We will fill out
<tt class="docutils literal">profit2</tt> from index <tt class="docutils literal"><span class="pre">n-1</span></tt> all the down to index <tt class="docutils literal">0</tt>. Now instead of seeing a newer price, we are seeing an
older price.</p>
<p>One both array have been filled out, we can add the number at the corresponding index and see which sum is the
greatest profit. Note that profit1[0] + profit2[0] should be the same as profit1[n-1] + profit2[n-1]. This represent
making one transaction in total where the other sums represent making two transactions.</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="kt">int</span> <span class="nf">maxProfit</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">prices</span><span class="o">)</span> <span class="o">{</span>

    <span class="kt">int</span> <span class="n">maxProfit</span> <span class="o">=</span> <span class="n">maxProfitOne</span><span class="o">(</span><span class="n">prices</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">prices</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">prices</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">2</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">profit</span> <span class="o">=</span> <span class="n">maxProfitOne</span><span class="o">(</span><span class="n">prices</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">+</span> <span class="n">maxProfitOne</span><span class="o">(</span><span class="n">prices</span><span class="o">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">prices</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">profit</span> <span class="o">&gt;</span> <span class="n">maxProfit</span><span class="o">)</span>
            <span class="n">maxProfit</span> <span class="o">=</span> <span class="n">profit</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">maxProfit</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">int</span> <span class="nf">maxProfitOne</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">prices</span><span class="o">,</span> <span class="kt">int</span> <span class="n">low</span><span class="o">,</span> <span class="kt">int</span> <span class="n">high</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">buyIndex</span> <span class="o">=</span> <span class="n">low</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">maxProfit</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">low</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">high</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&lt;</span> <span class="n">prices</span><span class="o">[</span><span class="n">buyIndex</span><span class="o">])</span> <span class="o">{</span>
            <span class="n">buyIndex</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">profit</span> <span class="o">=</span> <span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">-</span> <span class="n">prices</span><span class="o">[</span><span class="n">buyIndex</span><span class="o">];</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">profit</span> <span class="o">&gt;</span> <span class="n">maxProfit</span><span class="o">)</span>
                <span class="n">maxProfit</span> <span class="o">=</span> <span class="n">profit</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">maxProfit</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>

                </div>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Peter Hsieh
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://peter14f.github.io/pelican-blog/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://peter14f.github.io/pelican-blog/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://peter14f.github.io/pelican-blog/theme/js/respond.min.js"></script>


</body>
</html>